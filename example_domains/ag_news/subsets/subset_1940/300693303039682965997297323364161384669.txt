Microsoft was close to a deal with the European Commission earlier this year which would have revealed more of its secrets than it has now been ordered to hand over, a court was told yesterday.