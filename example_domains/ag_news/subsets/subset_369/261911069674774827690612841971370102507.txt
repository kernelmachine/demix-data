New Zealand beat Bangladesh by thre wickets in Dhaka despite figures of 5-31 by Aftab Ahmed.