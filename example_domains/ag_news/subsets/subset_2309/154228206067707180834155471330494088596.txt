England reach the Champions Trophy semi-finals as Andrew Flintoff's 104 earns victory over Sri Lanka.