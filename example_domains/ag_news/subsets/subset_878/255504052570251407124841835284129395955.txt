Microsoft is starting a scheme to replace pirate versions of Windows XP with legal ones.