Maria Sharapova has capped off a brilliant season by defeating Serena Williams 4-6, 6-2, 6-4 to win the season-ending WTA Tour Championships in Los Angeles.