Pakistan will meet West Indies in the Champions Trophy semi-final after a last-over victory over India at Edgbaston.