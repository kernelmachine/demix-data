Microsoft agreed yesterday to pay more than \$500 million to settle a potential antitrust lawsuit by rival software maker Novell but will likely have to fight another part of Novell #39;s claim in court.