Microsoft has been forced to fight for its lucrative Asian market, following government agreements to switch to other open-source software.