German champions Werder Bremen squeezed Spanish counterparts Valencia out of the Champions League after an absorbing and sometimes fractious clash at the Mestalla on Tuesday evening.