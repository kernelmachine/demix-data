Thomas Johansson denied top-seeded American Andre Agassi his second title of the year in a riveting three-set match while he collected his second If.