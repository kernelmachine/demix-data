Microsoft has been dropped from a \$3.6m contract in China because the government broke strict procurement rules, designed to give national firms an edge in securing software deals.