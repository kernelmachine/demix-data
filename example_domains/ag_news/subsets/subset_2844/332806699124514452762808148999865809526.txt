Last year's runner-up Juan Carlos Ferrero goes out of the US Open after a five-set battle with Stefan Koubek.