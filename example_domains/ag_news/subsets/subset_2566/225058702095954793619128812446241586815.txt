Marat Safin wins the Madrid Masters to edge ahead of Tim Henman in the race for the Masters Cup.