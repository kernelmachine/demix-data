The Sony Corporation today agreed to buy the Hollywood film studio Metro-Goldwyn-Mayer and its valuable film library after rival Time Warner withdrew from the bidding.