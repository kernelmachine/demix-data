South African Richard Sterne carded a brilliant closing round of 65 to win the Madrid Open and a place on the European Tour for the next two years.